<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<!-- Theme initialization script - Must be in head -->
	<script>
		// Immediately invoked function to set theme before page renders
		(function() {
			if (localStorage.getItem('theme') === 'dark' || 
				(!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
				document.documentElement.classList.add('dark');
			}
		})();
	</script>

	<title>@ViewData["Title"] - SmartHome</title>

	<!-- Tailwind CSS Output -->
	<link rel="stylesheet" href="~/css/output.css" asp-append-version="true" />

	<!-- Optional: Font or Favicon -->
	<link rel="icon" href="~/favicon.ico" />
</head>
<body class="min-h-screen bg-gray-100 font-sans text-gray-800 antialiased dark:tsext-gray-100 dark:bg-gray-950">
	<button onclick="toggleDarkMode()"
			class="absolute right-2 top-2 z-50 rounded-lg bg-gray-300 px-3 py-1 text-sm text-black shadow hover:bg-gray-400 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600">
		<i data-lucide="moon" class="h-5 w-5"></i>
	</button>

	<div class="mx-auto max-w-7xl p-4">

		<main role="main" class="space-y-6">
			@RenderBody()
		</main>
	</div>

	<!-- Scripts -->
	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="~/js/site.js" asp-append-version="true"></script>
	<script src="https://unpkg.com/lucide@latest"></script>
	<script>
		lucide.createIcons(); // Initialize Lucide after the DOM loads

		// Theme toggle + persistence
		function toggleDarkMode() {
			document.documentElement.classList.toggle('dark');
			localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
		}
	</script>
	@await RenderSectionAsync("Scripts", required: false)
</body>
</html>
